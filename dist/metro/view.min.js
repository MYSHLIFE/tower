((function(){Metro.View=function(){function a(a){this.controller=a||new Metro.Controller}return a}(),Metro.View.Helpers=function(){function a(){}return a.prototype.stylesheetLinkTag=function(a){return'<link href="'+this.assetPath(a,{directory:Metro.Assets.stylesheetDirectory,ext:"css"})+'"></link>'},a.prototype.assetPath=function(a,b){return b==null&&(b={}),b.digest===void 0&&(b.digest=!!Metro.env.match(/(development|test)/)),Metro.Application.assets().computePublicPath(a,b)},a.prototype.javascriptIncludeTag=function(a){},a.prototype.titleTag=function(a){return"<title>"+a+"</title>"},a.prototype.metaTag=function(a,b){},a.prototype.tag=function(a,b){},a.prototype.linkTag=function(a,b,c){},a.prototype.imageTag=function(a,b){},a}(),Metro.View.Lookup=function(){function a(){}return a.initialize=function(){return this.resolveLoadPaths(),this.resolveTemplatePaths(),Metro.Support.Dependencies.load(""+Metro.root+"/app/helpers")},a.teardown=function(){},a.resolveLoadPaths=function(){var a;return a=Metro.Support.Path,this.loadPaths=_.map(this.loadPaths,function(b){return a.expandPath(b)})},a.lookup=function(a){var b,c,d,e,f,g,h;b=Metro.View.pathsByName,d=b[a];if(d)return d;f=Metro.View.paths,c=new RegExp(a+"$","i");for(g=0,h=f.length;g<h;g++){e=f[g];if(e.split(".")[0].match(c))return b[a]=e,e}return null},a.resolveTemplatePaths=function(){var a,b,c,d,e,f;a=require("file"),c=this.paths,f=Metro.View.loadPaths;for(d=0,e=f.length;d<e;d++)b=f[d],a.walkSync(b,function(a,b,d){var e,f,g,h,i;i=[];for(g=0,h=d.length;g<h;g++)f=d[g],e=[a,f].join("/"),i.push(c.indexOf(e)===-1?c.push(e):void 0);return i});return c},a.loadPaths=["./spec/spec-app/app/views"],a.paths=[],a.pathsByName={},a.engine="jade",a.prettyPrint=!1,a}(),Metro.View.Rendering=function(){function a(){}return a.prototype.render=function(){var a,b,c,d,e;a=Array.prototype.slice.call(arguments,0,arguments.length);if(a.length>=2&&typeof a[a.length-1]=="function")return b=a.pop(),a.length===1?typeof a[0]=="string"?c={template:a[0]}:c=a[0]:(e=a[0],c=a[1],c.template=e),c||(c={}),c.locals=this.context(c),c.type||(c.type=Metro.View.engine),c.engine=Metro.engine(c.type),c.hasOwnProperty("layout")&&c.layout===!1?c.layout=!1:c.layout=c.layout||this.controller.layout(),d=this,this._renderBody(c,function(a,e){return d._renderLayout(e,c,b)});throw new Error("You must pass a callback to the render method")},a.prototype._renderBody=function(a,b){var c;return a.text?b(null,a.text):a.json?b(null,typeof a.json=="string"?a.json:JSON.stringify(a.json)):(a.inline||(c=Metro.View.lookup(a.template),c=Metro.Support.Path.read(c)),a.engine.render(c,a.locals,b))},a.prototype._renderLayout=function(a,b,c){var d;return b.layout?(d=Metro.View.lookup("layouts/"+b.layout),d=Metro.Support.Path.read(d),b.locals.yield=a,b.engine.render(d,b.locals,c)):c(null,a)},a.prototype.context=function(a){var b,c,d;b=this.controller,d={};for(c in b)c!=="constructor"&&(d[c]=b[c]);return d=require("underscore").extend(d,this.locals||{},a.locals),Metro.View.prettyPrint&&(d.pretty=!0),d},a}(),Metro.View.include(Metro.View.Lookup),Metro.View.include(Metro.View.Rendering)})).call(this)