((function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Metro.View=function(){function a(a){a==null&&(a={}),this._context=a}return b(a,Metro.Object),a.extend({engine:"jade",prettyPrint:!1,loadPaths:["app/views"],store:function(a){return a&&(this._store=a),this._store||(this._store=new Metro.Store.Memory)}}),a}(),Metro.View.Helpers={titleTag:function(a){return"<title>"+a+"</title>"},metaTag:function(a,b){return'<meta name="'+a+'" content="'+b+'"/>'},tag:function(a,b){},linkTag:function(a,b,c){},imageTag:function(a,b){},csrfMetaTag:function(){return this.metaTag("csrf-token",this.request.session._csrf)},contentTypeTag:function(a){return a==null&&(a="UTF-8"),'<meta charset="'+a+'" />'},javascriptTag:function(a){return'<script type="text/javascript" src="'+a+'" ></script>'},stylesheetTag:function(a){return'<link href="'+a+'" media="screen" rel="stylesheet" type="text/css"/>'},javascripts:function(a){var b,c,d,e,f,g;if(Metro.env==="production")return b=Metro.assetManifest,a=""+a+".js",b[a]&&(a=b[a]),c="/javascripts/"+a,Metro.assetHost&&(c=""+Metro.assetHost+c),this.javascriptTag(c);d=Metro.assets.javascripts[a],e=[];for(f=0,g=d.length;f<g;f++)c=d[f],e.push(this.javascriptTag("/javascripts"+c+".js"));return e.join("")},stylesheets:function(a){var b,c,d,e,f,g;if(Metro.env==="production")return b=Metro.assetManifest,a=""+a+".css",b[a]&&(a=b[a]),c="/stylesheets/"+a,Metro.assetHost&&(c=""+Metro.assetHost+c),this.stylesheetTag(c);d=Metro.assets.stylesheets[a],e=[];for(f=0,g=d.length;f<g;f++)c=d[f],e.push(this.stylesheetTag("/stylesheets"+c+".css"));return e.join("")},t:function(a){return Metro.translate(a)},l:function(a){return Metro.localize(string)}},Metro.View.Rendering={render:function(a,b){var c;return a.type||(a.type=this.constructor.engine),!a.hasOwnProperty("layout")&&this._context.layout&&(a.layout=this._context.layout()),a.locals=this._renderingContext(a),c=this,this._renderBody(a,function(d,e){return c._renderLayout(e,a,b)})},_renderBody:function(a,b){return a.text?b(null,a.text):a.json?b(null,typeof a.json=="string"?a.json:JSON.stringify(a.json)):(a.inline||(a.template=this._readTemplate(a.template,a.type)),this._renderString(a.template,a,b))},_renderLayout:function(a,b,c){var d;return b.layout?(d=this._readTemplate("layouts/"+b.layout,b.type),b.locals.yield=a,this._renderString(d,b,c)):c(null,a)},_renderString:function(a,b,c){var d;return b==null&&(b={}),b.type?(d=require("shift").engine(b.type),d.render(a,b.locals,c)):(d=require("shift"),b.locals.string=a,d.render(b.locals,c))},_renderingContext:function(a){var b,c,d,e;c=this,e=this._context;for(b in e)d=e[b],b.match(/^(render|constructor)/)||(this[b]=d);return c=Metro.Support.Object.extend(c,a.locals),this.constructor.prettyPrint&&(c.pretty=!0),c},_readTemplate:function(a,b){var c;c=this.constructor.store().find({path:a,ext:b});if(!c)throw new Error("Template '"+a+"' was not found.");return c}},Metro.View.include(Metro.View.Rendering),Metro.View.include(Metro.View.Helpers)})).call(this)