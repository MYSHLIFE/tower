((function(){var a=Object.prototype.hasOwnProperty,b=Array.prototype.indexOf||function(b){for(var c=0,d=this.length;c<d;c++)if(a.call(this,c)&&this[c]===b)return c;return-1},c=Array.prototype.slice;Metro.Support={},Metro.Support.Array={args:function(a,b,c,d){b==null&&(b=0),c==null&&(c=!1),d==null&&(d=!1),a=Array.prototype.slice.call(a,b,a.length);if(!c||a.length>=2&&typeof a[a.length-1]=="function")return a;throw new Error("You must pass a callback to the render method")},sortBy:function(a){var b,c,d,e;return d=this.args(arguments,1),c=d[d.length-1]instanceof Array?{}:d.pop(),e=function(a,b){return a>b?1:a<b?-1:0},b=function(a,b){var f,g;return f=[],g=[],d.forEach(function(d){var h,i,j,k;return i=d[0],k=d[1],h=a[i],j=b[i],typeof c[i]!="undefined"&&(h=c[i](h),j=c[i](j)),f.push(k*e(h,j)),g.push(k*e(j,h))}),f<g?-1:1},d=d.map(function(a){return a instanceof Array||(a=[a,"asc"]),a[1]==="desc"?a[1]=-1:a[1]=1,a}),a.sort(function(a,c){var d;return b(a,d=["included","extended","prototype","ClassMethods","InstanceMethods"])})}},Metro.Class=function(){function a(){}return a.alias=function(a,b){return Metro.Support.alias(this.prototype,a,b)},a.accessor=function(a,b){return Metro.Support.accessor(this.prototype,a,b),this},a.getter=function(a,b){return Metro.Support.getter(this.prototype,a,b),this},a.setter=function(a){return Metro.Support.setter(this.prototype,a),this},a.classAlias=function(a,b){return Metro.Support.alias(this,a,b),this},a.classAccessor=function(a,b){return Metro.Support.accessor(this,a,b),this},a.classGetter=function(a,b){return Metro.Support.getter(this,a,b),this},a.classSetter=function(a){return Metro.Support.setter(this,a),this},a.classEval=function(a){return a.call(this)},a.delegate=function(a,b){return b==null&&(b={}),Metro.Support.delegate(this.prototype,a,b),this},a.mixin=function(a,c){var d,e;for(d in c)e=c[d],b.call(specialProperties,d)<0&&(a[d]=e);return c},a.extend=function(a){var b;return this.mixin(this,a),b=a.extended,b&&b.apply(a),a},a.include=function(a){var b;return a.hasOwnProperty("ClassMethods")&&this.extend(a.ClassMethods),a.hasOwnProperty("InstanceMethods")&&this.include(a.InstanceMethods),this.mixin(this.prototype,a),b=a.included,b&&b.apply(a),a},a.instanceMethods=function(){return Metro.Support.methods(this.prototype)},a.classMethods=function(){return Metro.Support.methods(this)},a.className=function(){return Metro.Support.functionName(this)},a.prototype.className=function(){return this.constructor.className()},a}(),Metro.Support.I18n={defaultLanguage:"en",translate:function(a,b){b==null&&(b={}),b.hasOwnProperty("tense")&&(a+="."+b.tense);if(b.hasOwnProperty("count"))switch(b.count){case 0:a+=".none";break;case 1:a+=".one";break;default:a+=".other"}return this.interpolator().render(this.lookup(a,b.language),{locals:b})},t:this.prototype.translate,lookup:function(a,b){var c,d,e,f,g;b==null&&(b=this.defaultLanguage),d=a.split("."),e=this.store[b];try{for(f=0,g=d.length;f<g;f++)c=d[f],e=e[c]}catch(h){e=null}if(e==null)throw new Error("Translation doesn't exist for '"+a+"'");return e},store:{},interpolator:function(){return this._interpolator||(this._interpolator=new(require("shift").Mustache))}},Metro.Support.Number={isInt:function(a){return a===+a&&a===(a|0)},isFloat:function(a){return a===+a&&a!==(a|0)}},Metro.Support.Object={defineProperty:function(a,b,c){return c==null&&(c={}),Object.defineProperty(a,b,c)},functionName:function(a){var b;return a.__name__?a.__name__:a.name?a.name:(b=a.toString().match(/\W*function\s+([\w\$]+)\(/))!=null?b[1]:void 0},alias:function(a,b,c){return a[b]=a[c]},accessor:function(a,b,c){return a._accessors||(a._accessors=[]),a._accessors.push(b),this.getter(b,a,c),this.setter(b,a),this},setter:function(a,b){return a.hasOwnProperty("_setAttribute")||this.defineProperty(a,"_setAttribute",{enumerable:!1,configurable:!0,value:function(a,b){return this["_"+a]=b}}),a._setters||(a._setters=[]),a._setters.push(b),this.defineProperty(a,b,{enumerable:!0,configurable:!0,set:function(a){return this._setAttribute(b,a)}}),this},getter:function(a,b,c){return a.hasOwnProperty("_getAttribute")||this.defineProperty(a,"_getAttribute",{enumerable:!1,configurable:!0,value:function(a){return this["_"+a]}}),a._getters||(a._getters=[]),a._getters.push(b),this.defineProperty(a,b,{enumerable:!0,configurable:!0,get:function(){return this._getAttribute(b)||(c?this["_"+b]=c.apply(this):void 0)}}),this},variables:function(a){},accessors:function(a){},methods:function(a){var b,c,d;c=[];for(b in a)d=a[b],this.isFunction(d)&&c.push(b);return c},delegate:function(){var a,b,d,e,f,g,h,i,j;e=arguments[0],d=3<=arguments.length?c.call(arguments,1,h=arguments.length-1):(h=1,[]),f=arguments[h++],f==null&&(f={}),g=f.to,a=this.isFunction(e);for(i=0,j=d.length;i<j;i++)b=d[i],a?e[b]=function(){var a;return(a=this[g]())[b].apply(a,arguments)}:this.defineProperty(e,b,{enumerable:!0,configurable:!0,get:function(){return this[g]()[b]}});return from},isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},isA:function(a,b){},isHash:function(){var a;return a=arguments[0]||this,_.isObject(a)&&!_.isFunction(a)&&!_.isArray(a)},isPresent:function(a){return!this.isBlank(a)},isBlank:function(a){var b,c;for(b in a)return c=a[b],!1;return!0},has:function(a,b){return a.hasOwnProperty(b)}},Metro.Support.RegExp={regexpEscape:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},Metro.Support.String={camelize_rx:/(?:^|_|\-)(.)/g,capitalize_rx:/(^|\s)([a-z])/g,underscore_rx1:/([A-Z]+)([A-Z][a-z])/g,underscore_rx2:/([a-z\d])([A-Z])/g,constantize:function(a,b){return b==null&&(b=global),b[this.camelize(a)]},camelize:function(a,b){return a=a.replace(camelize_rx,function(a,b){return b.toUpperCase()}),b?a.substr(0,1).toLowerCase()+a.substr(1):a},underscore:function(a){return a.replace(underscore_rx1,"$1_$2").replace(underscore_rx2,"$1_$2").replace("-","_").toLowerCase()},singularize:function(a){var b;return b=a.length,a.substr(b-3)==="ies"?a.substr(0,b-3)+"y":a.substr(b-1)==="s"?a.substr(0,b-1):a},pluralize:function(a,b){var c,d;if(b){if(a===1)return b}else b=a;return d=b.length,c=b.substr(d-1),c==="y"?""+b.substr(0,d-1)+"ies":c==="s"?b:""+b+"s"},capitalize:function(a){return a.replace(capitalize_rx,function(a,b,c){return b+c.toUpperCase()})},trim:function(a){return a?a.trim():""},interpolate:function(a,b){var c,d,e;typeof a=="object"?(d=a[b.count],d||(d=a.other)):d=a;for(c in b)e=b[c],d=d.replace(new RegExp("%\\{"+c+"\\}","g"),e);return d}}})).call(this)